<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carpass - Painel Administrativo CFC</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">    
    <style>
        /* Configura√ß√µes Globais de Layout */
        :root {
            --primary: #2c3e50;
            --secondary: #34495e;
            --accent: #3498db;
            --success: #27ae60;
            --warning: #f1c40f;
            --danger: #e74c3c;
            --light: #ecf0f1;
        }

        body { display: flex; margin: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f6; }
        
        /* Abas */
        .tab-content { display: none; }
        .active-tab { display: block; animation: fadeIn 0.3s; }

        /* Sidebar */
        .sidebar { width: 250px; height: 100vh; background: var(--primary); color: white; position: fixed; padding: 20px; }
        .sidebar h2 { text-align: center; color: var(--accent); letter-spacing: 2px; }
        .sidebar nav a { display: block; color: white; text-decoration: none; padding: 12px; margin-bottom: 5px; border-radius: 8px; transition: 0.3s; }
        .sidebar nav a:hover, .sidebar nav a.active { background: var(--secondary); border-left: 4px solid var(--accent); }

        /* Conte√∫do Principal */
        .main-content { margin-left: 280px; padding: 30px; width: calc(100% - 310px); }
        .header { border-bottom: 2px solid #ddd; margin-bottom: 30px; padding-bottom: 10px; }

        /* Se√ß√£o de Finan√ßas (CFC) */
        .finance-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
        .card-finance { padding: 25px; border-radius: 12px; color: white; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .card-faturamento { background: linear-gradient(135deg, #27ae60, #2ecc71); }
        .card-repasses { background: linear-gradient(135deg, #e67e22, #f39c12); }
        .card-liquido { background: linear-gradient(135deg, #2980b9, #3498db); }
        .card-finance h4 { margin: 0; font-size: 0.85rem; text-transform: uppercase; opacity: 0.9; }
        .card-finance p { margin: 10px 0 0; font-size: 1.8rem; font-weight: bold; }

        /* Estilos do Formul√°rio de Finan√ßas */
        .finance-actions { display: flex; gap: 10px; margin-bottom: 20px; }
        .btn-finance { padding: 10px 15px; border: none; border-radius: 6px; color: white; cursor: pointer; font-weight: bold; }
        .finance-form { background: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; display: none; border: 1px solid #ddd; }

        /* Tabelas */
        .table-container { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        table { width: 100%; border-collapse: collapse; }
        th { background: #f8f9fa; padding: 15px; text-align: left; color: #7f8c8d; font-size: 0.85rem; }
        td { padding: 15px; border-bottom: 1px solid #eee; font-size: 0.9rem; }

        /* Monitoramento */
        .map-container {
            height: 500px; border-radius: 15px; overflow: hidden; border: 1px solid #ddd;
            background-image: url('https://user-images.githubusercontent.com/1414322/127195213-94c633a6-574d-4860-9d04-3687c47d6e49.png');
            background-size: cover; position: relative;
        }
        .car-marker { position: absolute; transition: all 1s ease; }
        .car-label { background: var(--primary); color: white; padding: 4px 10px; border-radius: 4px; font-size: 11px; }

        /* Status Badges */
        .status-pago { background: #e8f6ef; color: #27ae60; padding: 4px 8px; border-radius: 4px; font-weight: bold; }
        .status-pendente { background: #fff9e6; color: #f1c40f; padding: 4px 8px; border-radius: 4px; font-weight: bold; }
        .img-veiculo { width: 80px; height: 50px; object-fit: cover; border-radius: 6px; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<aside class="sidebar">
    <h2>CARPASS</h2>
    <nav>
        <a href="#" class="nav-link active" onclick="showTab('resumo')">üè† Dashboard</a>
        <a href="/cadastrar">üöó Cadastrar Carro</a>
        <a href="#" class="nav-link" onclick="showTab('rastreador')">üõ∞Ô∏è Monitoramento Plus</a>
        <a href="#" class="nav-link" onclick="showTab('financas')">üí∞ Finan√ßas do CFC</a>
        <a href="/checklist">üìã Checklist P√°tio</a>
        <hr style="border: 0.5px solid rgba(255,255,255,0.1); margin: 15px 0;">
        <a href="/instrutordb">üîÑ Mudar para Instrutor</a>
    </nav>
</aside>

<main class="main-content">
    
    <div id="resumo" class="tab-content active-tab">
        <header class="header"><h1>Vis√£o Geral da Frota</h1></header>
        
        <section style="display: flex; gap: 20px; margin-bottom: 30px;">
            <div style="background:white; padding:20px; flex:1; border-radius:10px; box-shadow:0 2px 5px rgba(0,0,0,0.1); text-align: center;">
                <h3 style="color:#7f8c8d; margin:0;">Frota Ativa</h3>
                <p style="font-size:32px; font-weight:bold; margin:10px 0;">{{ frota|length + 2 }}</p>
            </div>
            <div style="background:white; padding:20px; flex:1; border-radius:10px; box-shadow:0 2px 5px rgba(0,0,0,0.1); text-align: center;">
                <h3 style="color:#7f8c8d; margin:0;">Aulas em Andamento</h3>
                <p style="font-size:32px; font-weight:bold; color: var(--accent); margin:10px 0;">08</p>
            </div>
        </section>

        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Foto</th>
                        <th>Modelo</th>
                        <th>Chassi</th>
                        <th>Rastreador</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for carro in frota %}
                    <tr>
                        <td><img src="{{ url_for('static', filename='img/' + carro.imagem) }}" class="img-veiculo"></td>
                        <td><strong>{{ carro.modelo }}</strong></td>
                        <td>{{ carro.chassi }}</td>
                        <td>
                            {% if carro.status_rastreio == 'Ativo' %}
                                <span style="color:var(--success)">üõ∞Ô∏è Ativo</span>
                            {% elif carro.status_rastreio == 'Chip Solicitado' %}
                                <span style="color:var(--warning)">üöö Enviando Chip</span>
                            {% else %}
                                <span style="color:#ccc">üö´ Off</span>
                            {% endif %}
                        </td>
                        <td><span style="background:#e1f5fe; color:#01579b; padding:4px 8px; border-radius:4px; font-size:12px;">{{ carro.status_uso }}</span></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <div id="rastreador" class="tab-content">
        <header class="header"><h1>Monitoramento em Tempo Real</h1></header>
        <div class="map-container">
            <div class="car-marker" style="top: 30%; left: 40%;">
                <div class="car-label">HB20 - Jo√£o Silva</div>
                <div style="font-size: 25px;">üöó</div>
            </div>
            <div class="car-marker" style="top: 60%; left: 70%;">
                <div class="car-label">COROLLA - Ricardo</div>
                <div style="font-size: 25px;">üöó</div>
            </div>
        </div>
    </div>

    <div id="financas" class="tab-content">
        <header class="header"><h1>Gest√£o Financeira Unidade</h1></header>
        
        <div class="finance-actions">
            <button class="btn-finance" style="background: var(--success);" onclick="toggleFinanceForm()">+ Adicionar Lan√ßamento</button>
        </div>

        <div id="financeForm" class="finance-form">
            <h4 style="margin-top:0">Novo Registro Financeiro</h4>
            <div style="display: flex; gap: 10px;">
                <input type="text" placeholder="Descri√ß√£o" style="flex: 2; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                <input type="number" placeholder="Valor R$" style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                <select style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="lucro">Lucro (Entrada)</option>
                    <option value="gasto">Gasto (Sa√≠da)</option>
                </select>
                <button class="btn-finance" style="background: var(--primary);" onclick="toggleFinanceForm()">Salvar</button>
            </div>
        </div>

        <section class="finance-grid">
            <div class="card-finance card-faturamento">
                <h4>Receita Bruta</h4>
                <p>R$ 12.450,00</p>
            </div>
            <div class="card-finance card-repasses">
                <h4>Repasse Instrutores</h4>
                <p>R$ 5.250,00</p>
            </div>
            <div class="card-finance card-liquido">
                <h4>Lucro L√≠quido (CFC)</h4>
                <p>R$ 7.200,00</p>
            </div>
        </section>

        <div class="table-container">
            <h3>Balan√ßo Detalhado</h3>
            <table>
                <thead>
                    <tr>
                        <th>Instrutor</th>
                        <th>Ve√≠culo</th>
                        <th>Aulas</th>
                        <th>Total Bruto</th>
                        <th>Comiss√£o CFC</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Jo√£o Silva</td>
                        <td>HB20</td>
                        <td>42</td>
                        <td>R$ 3.780,00</td>
                        <td><strong>R$ 2.268,00</strong></td>
                        <td><span class="status-pago">RECEBIDO</span></td>
                    </tr>
                    <tr>
                        <td>Ricardo Santos</td>
                        <td>Corolla</td>
                        <td>38</td>
                        <td>R$ 4.560,00</td>
                        <td><strong>R$ 2.736,00</strong></td>
                        <td><span class="status-pendente">PROCESSANDO</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

</main>

<script>
    function showTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active-tab'));
        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
        document.getElementById(tabId).classList.add('active-tab');
        if (event) event.currentTarget.classList.add('active');
    }

    function toggleFinanceForm() {
        const form = document.getElementById('financeForm');
        form.style.display = form.style.display === 'block' ? 'none' : 'block';
    }
</script>

</body>
</html>